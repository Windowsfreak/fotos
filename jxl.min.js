!function(){"use strict";let e={useCache:!0,imageType:"jpeg"},t;function n(e){e instanceof HTMLImageElement&&e.src.endsWith(".jxl")?e.complete&&0===e.naturalHeight?c(e,!1,!1):e.onerror=()=>c(e,!1):e instanceof HTMLSourceElement&&e.srcset.endsWith(".jxl")?c(e,!1,!0):e instanceof Element&&getComputedStyle(e).backgroundImage.endsWith('.jxl")')&&c(e,!0,!1)}function r(n,r,c,o){let l=n.dataset.jxlSrc;if(r instanceof Blob)a(n,URL.createObjectURL(r),c,o);else{let i=document.createElement("canvas");i.width=r.width,i.height=r.height,i.getContext("2d").putImageData(r,0,0),i.toBlob(r=>{a(n,URL.createObjectURL(r),c,o),e.useCache&&t&&t.put(l,new Response(r))},"image/"+e.imageType)}}function a(t,n,r,a){r?t.style.backgroundImage='url("'+n+'")':a?(t.srcset=n,t.type="image/"+e.imageType):t.src=n}async function c(n,a,c){let l=n.dataset.jxlSrc=a?getComputedStyle(n).backgroundImage.slice(5,-2):c?n.srcset:n.currentSrc;if(a||c||(n.srcset="",n.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),e.useCache){try{t=t||await caches.open("jxl")}catch(i){}let s=t&&await t.match(l);if(s){let u=await s.blob();requestAnimationFrame(()=>r(n,u,a,c));return}}let d=await fetch(l);requestAnimationFrame(()=>o(d,n,a,c))}async function o(e,t,n,a){let c,o,l,i,s;function u(){i.read().then(d,f)}function d(e){if(e.done){h();return}let t=0;for(;t<e.value.length;){let n=e.value.length-t;n>262144&&(n=262144),c.HEAP8.set(e.value.slice(t,t+n),l),t+=n,$(n)||f("Processing error")}setTimeout(u,0)}function $(e){let i=function e(n){let r={error:!1,wantFlush:!1,copyPixels:!1};s=s||performance.now();let a=c._jxlProcessInput(o,l,n);return 2===a||(1===a?(r.wantFlush=!0,r.copyPixels=!0):0===a?(console.log("Finished decoding",t.dataset.jxlSrc,"in",performance.now()-s,"ms"),r.wantFlush=!1,r.copyPixels=!0):r.error=!0),r}(e);if(i.error)return!1;if(i.wantFlush&&c._jxlFlush(o),i.copyPixels){let u=c.HEAP32[o>>2],d=c.HEAP32[o+4>>2],$=c.HEAP32[o+8>>2],f=new Uint8Array(c.HEAP8.buffer),h=new ImageData(new Uint8ClampedArray(f.slice($,$+u*d*4)),u,d);requestAnimationFrame(()=>r(t,h,n,a))}return!0}function f(e){console.error(e),h()}function h(){c&&(c._jxlDestroyInstance(o),c._free(l)),c=o=l=void 0}if((o=(c=await JxlCodecModule())._jxlCreateInstance(!0,100))<4)return f("Cannot create decoder");l=c._malloc(262144),i=e.body.getReader(),u()}if(!window.crossOriginIsolated)throw"No COOP/COEP response headers";let l=WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),i=document.createElement("script");i.src=l?"jxl_decoder_simd.min.js":"jxl_decoder.min.js",i.onload=function e(){document.body&&document.body.querySelectorAll("*").forEach(n),new MutationObserver(e=>e.forEach(e=>e.addedNodes.forEach(n))).observe(document.documentElement,{subtree:!0,childList:!0})},document.head.appendChild(i)}();