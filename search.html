<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script>
  const root = './images/Website/';

  fixPath = path => encodeURI(path.replace('#', '%23'));
  trySplit = str => str && str.split('#')[0]
  function editDistance(s1, s2) {
    s1 = s1.toLowerCase();
    s2 = s2.toLowerCase();

    const costs = [];
    for (let i = 0; i <= s1.length; i++) {
      var lastValue = i;
      for (let j = 0; j <= s2.length; j++) {
        if (i === 0)
          costs[j] = j;
        else {
          if (j > 0) {
            let newValue = costs[j - 1];
            if (s1.charAt(i - 1) !== s2.charAt(j - 1))
              newValue = Math.min(Math.min(newValue, lastValue),
                      costs[j]) + 1;
            costs[j - 1] = lastValue;
            lastValue = newValue;
          }
        }
      }
      if (i > 0)
        costs[s2.length] = lastValue;
    }
    return costs[s2.length];
  }

  const path = /\/([^\/]*)$/.exec(location.href)
  if (path && path[1]) {
    const xhr = new XMLHttpRequest();
    xhr.open('GET', fixPath(root + '/') + '/index.json');
    xhr.onload = function () {
      if (this.status >= 200 && this.status < 300) {
        try {
          const json = JSON.parse(xhr.response);
          const x = path[1];
          let score = 100;
          let solution = './';
          json.subs.forEach(folder => {
            const y = trySplit(folder.d) || folder.n
            if (editDistance(x, y) < score) {
              score = editDistance(x, y);
              solution = './#' + folder.n;
            }
          });
          location.href = solution;
        } catch (e) {
          console.log(e);
          xhr.onerror(e);
        }
      } else {
        xhr.onerror(xhr.response);
      }
    };
    xhr.onerror = e => { console.error(e); };
    xhr.send();
  } else {
    location.href = './';
  }
</script>
<style>
    *, html, body {
        background: black;
    }
</style>
<body>
</body>
</html>